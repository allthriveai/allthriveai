# Snake Case to Camel Case Migration Plan

> **Created:** 2024-12-14
> **Status:** In Progress
> **ESLint Rule:** `@typescript-eslint/naming-convention` (currently set to `warn`)

## Background

The axios interceptor in `src/services/api.ts` automatically transforms API responses from `snake_case` to `camelCase`. However, many TypeScript interfaces still use `snake_case` property names, causing bugs where:

1. Code accesses `data.some_field` (snake_case)
2. But the actual transformed data has `data.someField` (camelCase)
3. Result: `undefined` values, UI not reflecting data

**Example bug fixed:** `PersonalizationSettings` interface used `excited_features` but the API response was transformed to `excitedFeatures`, so saved preferences weren't displayed after page reload.

## Migration Checklist

### Priority 1: `src/types/models.ts` (24 properties)

These types are used throughout the app.

#### User Interface
- [x] `is_staff` → `isStaff` *(fixed 2024-12-14)*
- [x] `is_superuser` → `isSuperuser` *(fixed 2024-12-14)*
- [x] `subscription_tier` → `subscriptionTier` *(fixed 2024-12-14)*
- [x] `total_points` → `totalPoints` *(removed - duplicate of totalPoints)*

#### RedditContent Interface
- [x] `num_comments` → `numComments` *(fixed 2024-12-14 - removed duplicate)*
- [x] `created_utc` → `createdUtc` *(fixed 2024-12-14 - removed duplicate)*
- [x] `thumbnail_url` → `thumbnailUrl` *(fixed 2024-12-14 - removed duplicate)*
- [x] `selftext_html` → `selftextHtml` *(fixed 2024-12-14 - removed duplicate)*
- [x] `upvote_ratio` → `upvoteRatio` *(fixed 2024-12-14 - removed duplicate)*
- [x] `link_flair_text` → `linkFlairText` *(fixed 2024-12-14 - removed duplicate)*
- [x] `link_flair_background_color` → `linkFlairBackgroundColor` *(fixed 2024-12-14 - removed duplicate)*
- [x] `is_video` → `isVideo` *(fixed 2024-12-14 - removed duplicate)*
- [x] `video_url` → `videoUrl` *(fixed 2024-12-14 - removed duplicate)*
- [x] `reddit_post_id` → `redditPostId` *(fixed 2024-12-14)*

#### FigmaContent Interface
- [x] `analysis_status` → `analysisStatus` *(fixed 2024-12-14)*
- [x] `analyzed_at` → `analyzedAt` *(fixed 2024-12-14)*

#### ProjectContent.github Interface
- [x] `analysis_status` → `analysisStatus` *(fixed 2024-12-14)*
- [x] `analyzed_at` → `analyzedAt` *(fixed 2024-12-14)*

#### UserPersonalization Interface
- [x] `manual_tags` → `manualTags` *(fixed 2024-12-14)*
- [x] `auto_generated_tags` → `autoGeneratedTags` *(fixed 2024-12-14)*
- [x] `available_taxonomies` → `availableTaxonomies` *(fixed 2024-12-14)*
- [x] `available_topics` → `availableTopics` *(fixed 2024-12-14)*
- [x] `selected_topics` → `selectedTopics` *(fixed 2024-12-14)*
- [x] `total_interactions` → `totalInteractions` *(fixed 2024-12-14)*

---

### Priority 2: `src/services/auth.ts` (2 properties)
- [x] `subscription_canceled` → `subscriptionCanceled` *(fixed 2024-12-14)*
- [x] `user_id` → `userId` *(fixed 2024-12-14)*

---

### Priority 3: `src/services/billing.ts` (8 properties)
- [x] `amount_paid` → `amountPaid` *(fixed 2024-12-14)*
- [x] `invoice_pdf` → `invoicePdf` *(fixed 2024-12-14)*
- [x] `hosted_invoice_url` → `hostedInvoiceUrl` *(fixed 2024-12-14 - removed, not used)*
- [x] `has_more` → `hasMore` *(fixed 2024-12-14)*
- [x] `subscription_id` → `subscriptionId` *(fixed 2024-12-14)*
- [x] `cancel_at_period_end` → `cancelAtPeriodEnd` *(fixed 2024-12-14)*
- [x] `period_end` → `periodEnd` *(fixed 2024-12-14)*

---

### Priority 4: `src/services/comments.ts` (6 properties)
- [x] `avatar_url` → `avatarUrl` *(fixed 2024-12-14)*
- [x] `user_vote` → `userVote` *(fixed 2024-12-14)*
- [x] `moderation_status` → `moderationStatus` *(fixed 2024-12-14)*
- [x] `created_at` → `createdAt` *(fixed 2024-12-14)*
- [x] `updated_at` → `updatedAt` *(fixed 2024-12-14)*
- [x] `vote_type` → `voteType` *(fixed 2024-12-14)*

---

### Priority 5: `src/services/impersonation.ts` (16 properties)
- [x] `first_name` → `firstName` *(fixed 2024-12-14)*
- [x] `last_name` → `lastName` *(fixed 2024-12-14)*
- [x] `avatar_url` → `avatarUrl` *(fixed 2024-12-14)*
- [x] `date_joined` → `dateJoined` *(fixed 2024-12-14)*
- [x] `is_guest` → `isGuest` *(fixed 2024-12-14)*
- [x] `admin_user` → `adminUser` *(fixed 2024-12-14)*
- [x] `target_user` → `targetUser` *(fixed 2024-12-14)*
- [x] `started_at` → `startedAt` *(fixed 2024-12-14)*
- [x] `ended_at` → `endedAt` *(fixed 2024-12-14)*
- [x] `ip_address` → `ipAddress` *(fixed 2024-12-14)*
- [x] `is_impersonating` → `isImpersonating` *(fixed 2024-12-14)*
- [x] `original_user` → `originalUser` *(fixed 2024-12-14)*
- [x] `session_id` → `sessionId` *(fixed 2024-12-14)*
- [ ] `user_id` → `userId` *(in function params - lower priority)*
- [ ] `admin_id` → `adminId` *(in function params - lower priority)*
- [ ] `target_id` → `targetId` *(in function params - lower priority)*

---

### Priority 6: `src/services/personalization.ts` (10 properties)

> Note: `PersonalizationSettings` interface was already fixed.

- [x] `exported_at` → `exportedAt` *(fixed 2024-12-14)*
- [x] `personalization_settings` → `personalizationSettings` *(fixed 2024-12-14)*
- [x] `manual_tags` → `manualTags` *(fixed 2024-12-14)*
- [x] `auto_generated_tags` → `autoGeneratedTags` *(fixed 2024-12-14)*
- [x] `confidence_score` → `confidenceScore` *(fixed 2024-12-14)*
- [x] `interaction_count` → `interactionCount` *(fixed 2024-12-14)*
- [x] `created_at` → `createdAt` *(fixed 2024-12-14)*
- [x] `updated_at` → `updatedAt` *(fixed 2024-12-14)*
- [x] `interaction_summary_last_90_days` → `interactionSummaryLast90Days` *(fixed 2024-12-14)*

---

### Priority 7: `src/services/tools.ts` (8 properties)
- [ ] `tool_type` → `toolType` *(request param - stays snake_case)*
- [ ] `pricing_model` → `pricingModel` *(request param - stays snake_case)*
- [ ] `has_free_tier` → `hasFreeTier` *(request param - stays snake_case)*
- [ ] `is_featured` → `isFeatured` *(request param - stays snake_case)*
- [ ] `is_verified` → `isVerified` *(request param - stays snake_case)*
- [ ] `page_size` → `pageSize` *(request param - stays snake_case)*
- [ ] `use_case` → `useCase` *(request param - stays snake_case)*
- [x] `helpful_count` → `helpfulCount` *(fixed 2024-12-14 - response type)*

---

### Priority 8: Other Service Files

#### `src/services/explore.ts` (2 properties)
- [ ] `page_size` → `pageSize` *(request param - stays snake_case)*
- [x] `search_type` → `searchType` *(fixed 2024-12-14)*

#### `src/services/figma.ts` (1 property)
- [x] `img_url` → `imgUrl` *(fixed 2024-12-14)*

#### `src/services/github.ts` (4 properties)
- [x] `error_code` → `errorCode` *(fixed 2024-12-14)*
- [x] `project_id` → `projectId` *(fixed 2024-12-14)*
- [x] `task_id` → `taskId` *(fixed 2024-12-14)*

#### `src/services/projects.ts` (2 properties)
- [x] `deleted_count` → `deletedCount` *(fixed 2024-12-14)*
- [x] `heart_count` → `heartCount` *(fixed 2024-12-14)*

#### `src/services/tracking.ts` (1 property)
- [ ] `project_id` → `projectId` *(request param - stays snake_case)*

#### `src/services/upload.ts` (5 properties)
- [x] `original_size` → `originalSize` *(fixed 2024-12-14)*
- [x] `optimized_size` → `optimizedSize` *(fixed 2024-12-14)*
- [x] `is_public` → `isPublic` *(fixed 2024-12-14)*
- [x] `file_type` → `fileType` *(fixed 2024-12-14)*
- [x] `file_size` → `fileSize` *(fixed 2024-12-14)*

---

## How to Fix Each File

### Step 1: Update the interface
```typescript
// Before
interface User {
  is_staff: boolean;
}

// After
interface User {
  isStaff: boolean;
}
```

### Step 2: Run TypeScript build
```bash
npm run build
```
TypeScript will show errors everywhere the old property name is used.

### Step 3: Fix all usages
Update every file that accesses the property:
```typescript
// Before
if (user.is_staff) { ... }

// After
if (user.isStaff) { ... }
```

### Step 4: Run tests
```bash
npm test
npm run e2e  # if applicable
```

### Step 5: Mark as complete
Check off the item in this document.

---

## Verification Commands

```bash
# Check current warning count
npx eslint src/services/*.ts src/types/models.ts 2>&1 | grep -c "naming-convention"

# Check specific file
npx eslint src/types/models.ts 2>&1 | grep "warning"

# Run full build to catch TypeScript errors
npm run build
```

---

## Completed Migrations

| Date | File | Properties Fixed | PR |
|------|------|------------------|-----|
| 2024-12-14 | `src/services/personalization.ts` | `PersonalizationSettings` interface (15 properties) | - |
| 2024-12-14 | `src/components/profile/Personalization.tsx` | All usages updated | - |
| 2024-12-14 | `src/types/models.ts` | `User` interface: `isStaff`, `isSuperuser`, `subscriptionTier` | - |
| 2024-12-14 | `src/context/AuthContext.tsx` | Updated `user.subscriptionTier`, `user.totalPoints` | - |
| 2024-12-14 | `src/components/events/RightEventsCalendarPanel.tsx` | Updated `user.isStaff`, `user.isSuperuser` | - |
| 2024-12-14 | `src/types/models.ts` | `UserPersonalization` interface (6 properties) | - |
| 2024-12-14 | `src/types/models.ts` | `RedditContent` interface - removed snake_case duplicates (10 properties) | - |
| 2024-12-14 | `src/types/models.ts` | `FigmaContent` interface (2 properties) | - |
| 2024-12-14 | `src/types/models.ts` | `ProjectContent.github` interface (2 properties) | - |
| 2024-12-14 | `src/services/impersonation.ts` | `ImpersonatableUser` interface (5 properties) | - |
| 2024-12-14 | `src/services/impersonation.ts` | `ImpersonationLog` interface (5 properties) | - |
| 2024-12-14 | `src/services/impersonation.ts` | `StartImpersonationResponse` interface (4 properties) | - |
| 2024-12-14 | `src/services/impersonation.ts` | `StopImpersonationResponse` interface (1 property) | - |
| 2024-12-14 | `src/components/projects/reddit/RedditThreadLayout.tsx` | Removed snake_case fallbacks | - |
| 2024-12-14 | `src/components/projects/ProjectCard.tsx` | Updated Reddit video detection | - |
| 2024-12-14 | `src/components/projects/figma/FigmaProjectLayout.tsx` | Updated `analyzedAt` usage | - |
| 2024-12-14 | `src/components/projects/github/GitHubProjectLayout.tsx` | Updated `analyzedAt` usage | - |
| 2024-12-14 | `src/components/projects/layouts/ProjectLayoutRouter.tsx` | Updated `analysisStatus` usage | - |
| 2024-12-14 | `src/pages/ProjectDetailPage.tsx` | Updated `analysisStatus` usage | - |
| 2024-12-14 | `src/pages/admin/ImpersonatePage.tsx` | All usages updated for impersonation interfaces | - |
| 2024-12-14 | `src/services/auth.ts` | `DeactivateAccountResponse`, `DeleteAccountResponse` (2 properties) | - |
| 2024-12-14 | `src/services/billing.ts` | `Invoice`, `InvoicesResponse`, return types (7 properties) | - |
| 2024-12-14 | `src/services/comments.ts` | `Comment`, `CommentVoteData` interfaces (6 properties) | - |
| 2024-12-14 | `src/services/personalization.ts` | `PersonalizationExport` interface (9 properties) | - |
| 2024-12-14 | `src/services/tools.ts` | `markReviewHelpful` return type (1 property) | - |
| 2024-12-14 | `src/services/upload.ts` | `UploadResponse`, `FileUploadResponse` (5 properties) | - |
| 2024-12-14 | `src/services/figma.ts` | `FigmaUser` interface (1 property) | - |
| 2024-12-14 | `src/services/projects.ts` | `bulkDeleteProjects` return type (1 property) | - |
| 2024-12-14 | `src/services/github.ts` | `GitHubError`, `TaskResult`, `TaskStatus`, return types (6 properties) | - |
| 2024-12-14 | `src/pages/settings/BillingSettingsPage.tsx` | Updated invoice property accesses | - |
| 2024-12-14 | `src/components/projects/CommentTray.tsx` | Updated comment property accesses | - |
| 2024-12-14 | `src/components/chat/IntelligentChatPanel.tsx` | Updated file upload property access | - |
| 2024-12-14 | `src/services/explore.ts` | `semanticSearch` response type (1 property) | - |
| 2024-12-14 | `src/services/projects.ts` | `toggleProjectLike` response type (1 property) | - |

---

## Notes

- The ESLint rule is currently set to `warn` in `eslint.config.js`
- Once all migrations are complete, change to `error` to prevent future issues
- The axios interceptor in `api.ts` handles the transformation automatically
- Request data is converted camelCase → snake_case for the Django backend
- Response data is converted snake_case → camelCase for the React frontend
